
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../serializer/">
      
      
        <link rel="next" href="../error/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Cache - Unfazed</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#unfazed" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../" title="Unfazed" class="md-header__button md-logo" aria-label="Unfazed" data-md-component="logo">
      
  <img src="../../../images/uz-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Unfazed
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cache
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../features/cache/" hreflang="zh-Hant" class="md-select__link">
              中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/unfazed-eco/unfazed" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    unfazed
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="Unfazed" class="md-nav__button md-logo" aria-label="Unfazed" data-md-component="logo">
      
  <img src="../../../images/uz-logo.png" alt="logo">

    </a>
    Unfazed
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/unfazed-eco/unfazed" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    unfazed
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 1 Install & Create Project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 2 Create Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 3 Models and Serializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 4 Endpoint and Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 5 Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 6 Test
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    App
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../route/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Route
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../middleware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Middleware
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifespan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lifespan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../request/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Request
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Response
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../endpoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../features/staticfiles.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Staticfiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tortoise-orm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ORM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Cache
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Cache
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      核心特性
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      缓存处理器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="缓存处理器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      核心组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      使用方式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      快速开始
    </span>
  </a>
  
    <nav class="md-nav" aria-label="快速开始">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 基本配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 基本使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      进程内内存缓存
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程内内存缓存">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      特性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      配置选项
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      高级用法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis" class="md-nav__link">
    <span class="md-ellipsis">
      Redis 缓存
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Redis 缓存">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redis_1" class="md-nav__link">
    <span class="md-ellipsis">
      原生 Redis 客户端
    </span>
  </a>
  
    <nav class="md-nav" aria-label="原生 Redis 客户端">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      特性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      使用示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      注意事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redis_2" class="md-nav__link">
    <span class="md-ellipsis">
      序列化 Redis 客户端
    </span>
  </a>
  
    <nav class="md-nav" aria-label="序列化 Redis 客户端">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      特性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      使用示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      注意事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      序列化和压缩
    </span>
  </a>
  
    <nav class="md-nav" aria-label="序列化和压缩">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      序列化器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="序列化器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      内置序列化器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      配置自定义序列化器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      压缩器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="压缩器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      内置压缩器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      配置自定义压缩器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      缓存装饰器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="缓存装饰器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      基本用法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      高级用法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      装饰器特性
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      最佳实践
    </span>
  </a>
  
    <nav class="md-nav" aria-label="最佳实践">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 缓存策略设计
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. 性能优化
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../error/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OPENAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../command/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Command
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contrib
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Contrib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib/admin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Admin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib/auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib/session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-note/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReleaseNote
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      核心特性
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      缓存处理器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="缓存处理器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      核心组件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      使用方式
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      快速开始
    </span>
  </a>
  
    <nav class="md-nav" aria-label="快速开始">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 基本配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 基本使用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      进程内内存缓存
    </span>
  </a>
  
    <nav class="md-nav" aria-label="进程内内存缓存">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      特性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      配置选项
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      高级用法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#redis" class="md-nav__link">
    <span class="md-ellipsis">
      Redis 缓存
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Redis 缓存">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#redis_1" class="md-nav__link">
    <span class="md-ellipsis">
      原生 Redis 客户端
    </span>
  </a>
  
    <nav class="md-nav" aria-label="原生 Redis 客户端">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      特性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      使用示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      注意事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redis_2" class="md-nav__link">
    <span class="md-ellipsis">
      序列化 Redis 客户端
    </span>
  </a>
  
    <nav class="md-nav" aria-label="序列化 Redis 客户端">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      特性
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      配置
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      使用示例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      注意事项
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      序列化和压缩
    </span>
  </a>
  
    <nav class="md-nav" aria-label="序列化和压缩">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      序列化器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="序列化器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      内置序列化器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      配置自定义序列化器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      压缩器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="压缩器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      内置压缩器
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      配置自定义压缩器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      缓存装饰器
    </span>
  </a>
  
    <nav class="md-nav" aria-label="缓存装饰器">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      基本用法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      高级用法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    <span class="md-ellipsis">
      装饰器特性
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    <span class="md-ellipsis">
      最佳实践
    </span>
  </a>
  
    <nav class="md-nav" aria-label="最佳实践">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1_1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 缓存策略设计
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2_1" class="md-nav__link">
    <span class="md-ellipsis">
      2. 性能优化
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="unfazed">Unfazed 缓存系统</h1>
<p>Unfazed 提供了完整的缓存解决方案，支持多种缓存后端，包括进程内内存缓存和 Redis 缓存。缓存系统设计灵活，支持序列化、压缩、键前缀、版本控制等高级功能。</p>
<p>更高级的 redis client 见 <a href="https://github.com/unfazed-eco/unfazed-redis">unfazed-redis</a></p>
<p>带监控的 redis client 见 <a href="https://github.com/unfazed-eco/unfazed-prometheus">unfazed-prometheus</a></p>
<h2 id="_1">核心特性</h2>
<ul>
<li><strong>多后端支持</strong>: 进程内内存缓存和 Redis 缓存</li>
<li><strong>异步操作</strong>: 全异步 API 设计，支持高并发</li>
<li><strong>序列化支持</strong>: 自动序列化复杂 Python 对象</li>
<li><strong>压缩支持</strong>: 可选的 zlib 压缩，减少存储空间</li>
<li><strong>键管理</strong>: 支持键前缀、版本控制、自动过期</li>
<li><strong>装饰器支持</strong>: <code>@cached</code> 装饰器简化缓存使用</li>
</ul>
<h2 id="_2">缓存处理器</h2>
<p>Unfazed 缓存系统使用 <code>CacheHandler</code> 类管理多个缓存后端，提供统一的接口。</p>
<h3 id="_3">核心组件</h3>
<ul>
<li><strong>caches</strong>: 全局缓存处理器实例，管理所有配置的缓存后端</li>
<li><strong>CacheHandler</strong>: 继承自 <code>Storage[CacheBackend]</code>，提供缓存生命周期管理</li>
</ul>
<h3 id="_4">使用方式</h3>
<pre><code class="language-python">from unfazed.cache import caches

# 获取默认缓存
default_cache = caches[&quot;default&quot;]

# 获取特定缓存
redis_cache = caches[&quot;redis&quot;]

</code></pre>
<h2 id="_5">快速开始</h2>
<h3 id="1">1. 基本配置</h3>
<pre><code class="language-python"># settings.py
UNFAZED_SETTINGS = {
    &quot;CACHE&quot;: {
        &quot;default&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.locmem.LocMemCache&quot;,
            &quot;LOCATION&quot;: &quot;default_cache&quot;,
            &quot;OPTIONS&quot;: {
                &quot;MAX_ENTRIES&quot;: 1000,
                &quot;PREFIX&quot;: &quot;default&quot;,
                &quot;VERSION&quot;: 1,
            },
        },
        &quot;redis&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.redis.defaultclient.DefaultBackend&quot;,
            &quot;LOCATION&quot;: &quot;redis://localhost:6379/0&quot;,
            &quot;OPTIONS&quot;: {
                &quot;PREFIX&quot;: &quot;app_cache&quot;,
                &quot;MAX_CONNECTIONS&quot;: 10,
                &quot;HEALTH_CHECK_INTERVAL&quot;: 30,
            },
        },
        &quot;redis_serialized&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.redis.serializedclient.SerializerBackend&quot;,
            &quot;LOCATION&quot;: &quot;redis://localhost:6379/0&quot;,
            &quot;OPTIONS&quot;: {
                &quot;PREFIX&quot;: &quot;serialized_cache&quot;,
                &quot;SERIALIZER&quot;: &quot;unfazed.cache.serializers.pickle.PickleSerializer&quot;,
                &quot;COMPRESSOR&quot;: &quot;unfazed.cache.compressors.zlib.ZlibCompressor&quot;,
            },
        },
    }
}
</code></pre>
<h3 id="2">2. 基本使用</h3>
<pre><code class="language-python">from unfazed.cache import caches

async def basic_usage():
    # 获取缓存实例
    cache = caches[&quot;default&quot;]

    # 设置缓存
    await cache.set(&quot;user:1&quot;, &quot;value&quot;, timeout=3600)

    # 获取缓存
    user = await cache.get(&quot;user:1&quot;)

    # 检查键是否存在
    exists = await cache.has_key(&quot;user:1&quot;)

    # 删除缓存
    await cache.delete(&quot;user:1&quot;)

    # 清空所有缓存
    await cache.clear()
</code></pre>
<h2 id="_6">进程内内存缓存</h2>
<p>进程内内存缓存 (<code>LocMemCache</code>) 适用于单进程应用，提供高性能的内存存储。</p>
<h3 id="_7">特性</h3>
<ul>
<li><strong>线程安全</strong>: 使用 asyncio Lock 保证并发安全</li>
<li><strong>自动清理</strong>: 支持 TTL 和最大条目数限制</li>
<li><strong>LRU 策略</strong>: 使用 OrderedDict 实现 LRU 缓存淘汰</li>
<li><strong>版本控制</strong>: 支持键版本管理</li>
<li><strong>键前缀</strong>: 支持键名前缀隔离</li>
</ul>
<h3 id="_8">配置选项</h3>
<pre><code class="language-python">UNFAZED_SETTINGS = {
    &quot;CACHE&quot;: {
        &quot;default&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.locmem.LocMemCache&quot;,
            &quot;LOCATION&quot;: &quot;app_cache&quot;,  # 缓存实例唯一标识
            &quot;OPTIONS&quot;: {
                &quot;PREFIX&quot;: &quot;app&quot;,      # 键前缀
                &quot;VERSION&quot;: 1,         # 默认版本号
                &quot;MAX_ENTRIES&quot;: 1000,  # 最大缓存条目数
            },
        },
    }
}
</code></pre>
<h3 id="_9">高级用法</h3>
<pre><code class="language-python">from unfazed.cache import caches
from unfazed.cache.backends.locmem import LocMemCache

async def advanced_locmem_usage():
    cache: LocMemCache = caches[&quot;default&quot;]

    # 计数器操作
    await cache.set(&quot;counter&quot;, 0)
    await cache.incr(&quot;counter&quot;)      # 增加 1
    await cache.incr(&quot;counter&quot;, 5)   # 增加 5
    await cache.decr(&quot;counter&quot;, 2)   # 减少 2

    # 版本控制
    await cache.set(&quot;key&quot;, &quot;value&quot;, version=1)
    await cache.set(&quot;key&quot;, &quot;new_value&quot;, version=2)

    # 检查键是否存在
    if await cache.has_key(&quot;key&quot;):
        value = await cache.get(&quot;key&quot;)
</code></pre>
<h2 id="redis">Redis 缓存</h2>
<p>Unfazed 提供两种 Redis 缓存后端：原生客户端和序列化客户端。</p>
<h3 id="redis_1">原生 Redis 客户端</h3>
<p>原生 Redis 客户端 (<code>DefaultBackend</code>) 完全继承 <code>redis-py</code> 的 <code>Redis</code> 类，支持所有 Redis 命令。</p>
<h4 id="_10">特性</h4>
<ul>
<li><strong>完整 Redis 支持</strong>: 支持所有 Redis 命令和功能</li>
<li><strong>连接池管理</strong>: 自动连接池和健康检查</li>
<li><strong>SSL/TLS 支持</strong>: 支持安全连接</li>
<li><strong>重试机制</strong>: 自动重试和错误处理</li>
<li><strong>键前缀</strong>: 手动键前缀管理</li>
</ul>
<h4 id="_11">配置</h4>
<pre><code class="language-python">UNFAZED_SETTINGS = {
    &quot;CACHE&quot;: {
        &quot;redis&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.redis.defaultclient.DefaultBackend&quot;,
            &quot;LOCATION&quot;: &quot;redis://username:password@localhost:6379/0&quot;,
            &quot;OPTIONS&quot;: {
                &quot;PREFIX&quot;: &quot;app_cache&quot;,
                &quot;MAX_CONNECTIONS&quot;: 20,
                &quot;HEALTH_CHECK_INTERVAL&quot;: 30,
                &quot;SOCKET_TIMEOUT&quot;: 5.0,
                &quot;SOCKET_CONNECT_TIMEOUT&quot;: 2.0,
                &quot;RETRY_ON_TIMEOUT&quot;: True,
                &quot;RETRY_ON_ERROR&quot;: True,
                &quot;SSL&quot;: False,
            },
        },
    }
}
</code></pre>
<h4 id="_12">使用示例</h4>
<pre><code class="language-python">from unfazed.cache import caches
from unfazed.cache.backends.redis.defaultclient import DefaultBackend

async def redis_usage():
    cache: DefaultBackend = caches[&quot;redis&quot;]

    # 基本操作
    await cache.set(&quot;key&quot;, &quot;value&quot;)
    value = await cache.get(&quot;key&quot;)

    # 使用键前缀
    prefixed_key = cache.make_key(&quot;user:1&quot;)
    await cache.set(prefixed_key, {&quot;name&quot;: &quot;李四&quot;})

    # Redis 特定功能
    await cache.client.hset(&quot;user:1&quot;, &quot;name&quot;, &quot;王五&quot;)
    await cache.client.hset(&quot;user:1&quot;, &quot;age&quot;, &quot;30&quot;)
    user_data = await cache.client.hgetall(&quot;user:1&quot;)

    # 列表操作
    await cache.client.lpush(&quot;queue&quot;, &quot;item1&quot;)
    await cache.client.lpush(&quot;queue&quot;, &quot;item2&quot;)
    item = await cache.client.rpop(&quot;queue&quot;)

    # 集合操作
    await cache.client.sadd(&quot;users&quot;, &quot;user1&quot;, &quot;user2&quot;)
    users = await cache.client.smembers(&quot;users&quot;)

    # 有序集合
    await cache.client.zadd(&quot;scores&quot;, {&quot;alice&quot;: 100, &quot;bob&quot;: 90})
    top_scores = await cache.client.zrevrange(&quot;scores&quot;, 0, 2, withscores=True)
</code></pre>
<h4 id="_13">注意事项</h4>
<ul>
<li><strong>键隔离</strong>: 在生产环境中需要手动管理键前缀，避免键冲突</li>
<li><strong>序列化</strong>: 只支持字符串和字节数据，复杂对象需要手动序列化</li>
<li><strong>连接管理</strong>: 支持异步上下文管理器，自动连接管理</li>
</ul>
<h3 id="redis_2">序列化 Redis 客户端</h3>
<p>序列化 Redis 客户端 (<code>SerializerBackend</code>) 是对原生客户端的封装，提供自动序列化和压缩功能。</p>
<h4 id="_14">特性</h4>
<ul>
<li><strong>自动序列化</strong>: 支持存储 Python 对象（dict、list、set、tuple 等）</li>
<li><strong>压缩支持</strong>: 可选的 zlib 压缩，减少存储空间</li>
<li><strong>类型保持</strong>: 保持原始数据类型</li>
<li><strong>键前缀</strong>: 自动键前缀管理</li>
<li><strong>计数器支持</strong>: 支持 incr/decr 操作</li>
</ul>
<h4 id="_15">配置</h4>
<pre><code class="language-python">UNFAZED_SETTINGS = {
    &quot;CACHE&quot;: {
        &quot;redis_serialized&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.redis.serializedclient.SerializerBackend&quot;,
            &quot;LOCATION&quot;: &quot;redis://localhost:6379/0&quot;,
            &quot;OPTIONS&quot;: {
                &quot;PREFIX&quot;: &quot;app_cache&quot;,
                &quot;SERIALIZER&quot;: &quot;unfazed.cache.serializers.pickle.PickleSerializer&quot;,
                &quot;COMPRESSOR&quot;: &quot;unfazed.cache.compressors.zlib.ZlibCompressor&quot;,
                &quot;MAX_CONNECTIONS&quot;: 10,
                &quot;HEALTH_CHECK_INTERVAL&quot;: 30,
            },
        },
    }
}
</code></pre>
<h4 id="_16">使用示例</h4>
<pre><code class="language-python">from unfazed.cache import caches
from unfazed.cache.backends.redis.serializedclient import SerializerBackend

async def serialized_redis_usage():
    cache: SerializerBackend = caches[&quot;redis_serialized&quot;]

    # 存储复杂对象
    user_data = {
        &quot;name&quot;: &quot;赵六&quot;,
        &quot;age&quot;: 28,
        &quot;hobbies&quot;: [&quot;读书&quot;, &quot;游泳&quot;, &quot;编程&quot;],
        &quot;profile&quot;: {
            &quot;email&quot;: &quot;zhaoliu@example.com&quot;,
            &quot;phone&quot;: &quot;13800138000&quot;
        }
    }

    await cache.set(&quot;user:1&quot;, user_data, timeout=3600)

    # 存储列表
    await cache.set(&quot;numbers&quot;, [1, 2, 3, 4, 5])

    # 存储集合
    await cache.set(&quot;tags&quot;, {&quot;python&quot;, &quot;fastapi&quot;, &quot;redis&quot;})

    # 计数器操作
    await cache.set(&quot;visits&quot;, 0)
    await cache.incr(&quot;visits&quot;)
    await cache.incr(&quot;visits&quot;, 5)

    # 获取数据
    user = await cache.get(&quot;user:1&quot;)
    numbers = await cache.get(&quot;numbers&quot;)
    tags = await cache.get(&quot;tags&quot;)
    visits = await cache.get(&quot;visits&quot;)

    # 检查键是否存在
    if await cache.has_key(&quot;user:1&quot;):
        print(&quot;用户数据存在&quot;)

    # 删除键
    await cache.delete(&quot;user:1&quot;)
</code></pre>
<h4 id="_17">注意事项</h4>
<ul>
<li><strong>并发安全</strong>: 在生产环境中建议配合锁机制使用</li>
<li><strong>序列化限制</strong>: 不支持某些特殊对象（如文件句柄、网络连接等）</li>
<li><strong>性能考虑</strong>: 序列化和压缩会增加 CPU 开销</li>
<li><strong>存储空间</strong>: 压缩可以显著减少存储空间，特别是对于重复数据</li>
</ul>
<h2 id="_18">序列化和压缩</h2>
<h3 id="_19">序列化器</h3>
<p>Unfazed 提供了可扩展的序列化器接口，默认使用 Pickle 序列化器。</p>
<h4 id="_20">内置序列化器</h4>
<pre><code class="language-python"># Pickle 序列化器（默认）
from unfazed.cache.serializers.pickle import PickleSerializer

# 自定义序列化器
from unfazed.protocol import SerializerBase
import json

class JSONSerializer(SerializerBase):
    def dumps(self, value):
        return json.dumps(value).encode('utf-8')

    def loads(self, value):
        return json.loads(value.decode('utf-8'))
</code></pre>
<h4 id="_21">配置自定义序列化器</h4>
<pre><code class="language-python">UNFAZED_SETTINGS = {
    &quot;CACHE&quot;: {
        &quot;custom&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.redis.serializedclient.SerializerBackend&quot;,
            &quot;LOCATION&quot;: &quot;redis://localhost:6379/0&quot;,
            &quot;OPTIONS&quot;: {
                &quot;SERIALIZER&quot;: &quot;myapp.serializers.JSONSerializer&quot;,
                &quot;PREFIX&quot;: &quot;custom_cache&quot;,
            },
        },
    }
}
</code></pre>
<h3 id="_22">压缩器</h3>
<p>Unfazed 提供了可扩展的压缩器接口，默认使用 zlib 压缩器。</p>
<h4 id="_23">内置压缩器</h4>
<pre><code class="language-python"># Zlib 压缩器（默认）
from unfazed.cache.compressors.zlib import ZlibCompressor

# 自定义压缩器
from unfazed.protocol import CompressorBase
import lz4

class LZ4Compressor(CompressorBase):
    def compress(self, value):
        return lz4.compress(value)

    def decompress(self, value):
        return lz4.decompress(value)
</code></pre>
<h4 id="_24">配置自定义压缩器</h4>
<pre><code class="language-python">UNFAZED_SETTINGS = {
    &quot;CACHE&quot;: {
        &quot;compressed&quot;: {
            &quot;BACKEND&quot;: &quot;unfazed.cache.backends.redis.serializedclient.SerializerBackend&quot;,
            &quot;LOCATION&quot;: &quot;redis://localhost:6379/0&quot;,
            &quot;OPTIONS&quot;: {
                &quot;SERIALIZER&quot;: &quot;unfazed.cache.serializers.pickle.PickleSerializer&quot;,
                &quot;COMPRESSOR&quot;: &quot;myapp.compressors.LZ4Compressor&quot;,
                &quot;PREFIX&quot;: &quot;compressed_cache&quot;,
            },
        },
    }
}
</code></pre>
<h2 id="_25">缓存装饰器</h2>
<p>Unfazed 提供了强大的 <code>@cached</code> 装饰器，支持异步和同步函数缓存。</p>
<h3 id="_26">基本用法</h3>
<pre><code class="language-python">from unfazed.cache.decorators import cached

# 基础缓存
@cached(timeout=300)
async def get_user_info(user_id: int) -&gt; dict:
    # 模拟数据库查询
    return {&quot;user_id&quot;: user_id, &quot;name&quot;: &quot;张三&quot;, &quot;age&quot;: 25}

# 使用特定缓存后端
@cached(using=&quot;redis&quot;, timeout=600)
async def get_product_info(product_id: int) -&gt; dict:
    return {&quot;product_id&quot;: product_id, &quot;name&quot;: &quot;商品A&quot;, &quot;price&quot;: 99.99}

# 指定缓存键参数
@cached(timeout=1800, include=[&quot;user_id&quot;, &quot;category&quot;])
async def get_user_preferences(user_id: int, category: str, page: int = 1) -&gt; list:
    return [{&quot;pref_id&quot;: 1, &quot;category&quot;: category, &quot;user_id&quot;: user_id}]
</code></pre>
<h3 id="_27">高级用法</h3>
<pre><code class="language-python">from unfazed.cache.decorators import cached

# 多层缓存策略
@cached(using=&quot;local_memory&quot;, timeout=60)      # 本地缓存 1 分钟
@cached(using=&quot;redis&quot;, timeout=3600)           # Redis 缓存 1 小时
async def get_expensive_data(key: str) -&gt; dict:
    # 模拟昂贵的计算或数据库查询
    return {&quot;key&quot;: key, &quot;data&quot;: &quot;expensive_result&quot;, &quot;timestamp&quot;: time.time()}

# 条件缓存
@cached(timeout=300)
async def get_conditional_data(user_id: int, force_refresh: bool = False) -&gt; dict:
    if force_refresh:
        # 强制刷新缓存
        return await get_conditional_data(user_id, force_update=True)

    return {&quot;user_id&quot;: user_id, &quot;data&quot;: &quot;cached_result&quot;}

# 缓存键自定义
@cached(timeout=600, include=[&quot;user_id&quot;, &quot;role&quot;])
async def get_user_permissions(user_id: int, role: str, context: str = &quot;default&quot;) -&gt; list:
    # context 参数不会影响缓存键
    return [f&quot;permission_{role}_{context}&quot;]
</code></pre>
<h3 id="_28">装饰器特性</h3>
<ul>
<li><strong>异步支持</strong>: 完全支持异步函数</li>
<li><strong>同步支持</strong>: 自动将同步函数包装为异步（使用 <code>run_in_threadpool</code>）</li>
<li><strong>参数过滤</strong>: 可选择特定参数作为缓存键</li>
<li><strong>强制更新</strong>: 支持 <code>force_update=True</code> 绕过缓存</li>
<li><strong>键生成</strong>: 自动生成基于函数签名的缓存键（格式：<code>module:function_name:param1_value:param2_value</code>）</li>
<li><strong>错误处理</strong>: 优雅处理缓存错误</li>
<li><strong>警告提示</strong>: 对位置参数使用发出警告，建议使用关键字参数</li>
</ul>
<h2 id="_29">最佳实践</h2>
<h3 id="1_1">1. 缓存策略设计</h3>
<pre><code class="language-python"># 分层缓存策略
@cached(using=&quot;local_memory&quot;, timeout=30)    # 热点数据本地缓存
@cached(using=&quot;redis&quot;, timeout=3600)         # 稳定数据 Redis 缓存
async def get_user_profile(user_id: int) -&gt; dict:
    return await fetch_user_from_database(user_id)

# 缓存预热
async def warm_up_cache():
    user_ids = [1, 2, 3, 4, 5]
    for user_id in user_ids:
        await get_user_profile(user_id)
</code></pre>
<h3 id="2_1">2. 性能优化</h3>
<pre><code class="language-python"># 批量操作
async def batch_cache_operations():
    cache = caches[&quot;redis&quot;]

    # 批量设置
    pipeline = cache.client.pipeline()
    for i in range(100):
        pipeline.set(f&quot;key_{i}&quot;, f&quot;value_{i}&quot;)
    await pipeline.execute()

    # 批量获取
    keys = [f&quot;key_{i}&quot; for i in range(100)]
    values = await cache.client.mget(keys)

# 异步并发
import asyncio

async def concurrent_cache_operations():
    cache = caches[&quot;default&quot;]

    # 并发设置多个键
    tasks = [
        cache.set(f&quot;key_{i}&quot;, f&quot;value_{i}&quot;)
        for i in range(10)
    ]
    await asyncio.gather(*tasks)
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>
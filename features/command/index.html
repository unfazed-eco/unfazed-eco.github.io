
<!doctype html>
<html lang="zh-Hant" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../openapi/">
      
      
        <link rel="next" href="../testclient/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Command - Unfazed</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#unfazed" class="md-skip">
          跳轉至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="頁首">
    <a href="../.." title="Unfazed" class="md-header__button md-logo" aria-label="Unfazed" data-md-component="logo">
      
  <img src="../../images/uz-logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Unfazed
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Command
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="選擇語言">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="zh-Hant" class="md-select__link">
              中文
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../en/features/command/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
    
      <div class="md-header__source">
        <a href="https://github.com/unfazed-eco/unfazed" title="前往倉庫" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    unfazed
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="導航" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Unfazed" class="md-nav__button md-logo" aria-label="Unfazed" data-md-component="logo">
      
  <img src="../../images/uz-logo.png" alt="logo">

    </a>
    Unfazed
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/unfazed-eco/unfazed" title="前往倉庫" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    unfazed
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 1 Install & Create Project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 2 Create Application
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 3 Models and Serializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 4 Endpoint and Schema
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 5 Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/part6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Part 6 Test
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Features
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Features
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../app/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    App
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../route/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Route
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../middleware/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Middleware
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lifespan/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lifespan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Logging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../request/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Request
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../response/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Response
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../endpoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Endpoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../staticfiles.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Staticfiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tortoise-orm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ORM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../serializer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serializer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cache/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../error/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Error
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../openapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OPENAPI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Command
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Command
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目錄">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目錄
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      命令系统架构
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      快速开始
    </span>
  </a>
  
    <nav class="md-nav" aria-label="快速开始">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      创建自定义命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      异步命令示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      内置命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="内置命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      项目管理命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="项目管理命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#startproject-" class="md-nav__link">
    <span class="md-ellipsis">
      startproject - 创建新项目
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startapp-" class="md-nav__link">
    <span class="md-ellipsis">
      startapp - 创建新应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      开发工具命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="开发工具命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-shell" class="md-nav__link">
    <span class="md-ellipsis">
      shell - 交互式 Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-openapi-openapi" class="md-nav__link">
    <span class="md-ellipsis">
      export-openapi - 导出 OpenAPI 文档
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aerich" class="md-nav__link">
    <span class="md-ellipsis">
      数据库迁移命令（Aerich）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数据库迁移命令（Aerich）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init-db-" class="md-nav__link">
    <span class="md-ellipsis">
      init-db - 初始化数据库
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrate-" class="md-nav__link">
    <span class="md-ellipsis">
      migrate - 生成迁移文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-" class="md-nav__link">
    <span class="md-ellipsis">
      upgrade - 执行迁移
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downgrade-" class="md-nav__link">
    <span class="md-ellipsis">
      downgrade - 回滚迁移
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history-" class="md-nav__link">
    <span class="md-ellipsis">
      history - 查看迁移历史
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heads-" class="md-nav__link">
    <span class="md-ellipsis">
      heads - 查看迁移头
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inspectdb-" class="md-nav__link">
    <span class="md-ellipsis">
      inspectdb - 检查数据库
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      启动开发服务器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      命令扩展
    </span>
  </a>
  
    <nav class="md-nav" aria-label="命令扩展">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unfazed_1" class="md-nav__link">
    <span class="md-ellipsis">
      访问 Unfazed 应用实例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      错误处理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      高级用法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="高级用法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      命令参数类型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../testclient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Test Client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Contrib
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Contrib
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib/admin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Admin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib/auth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../contrib/session/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Session
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../release-note/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReleaseNote
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目錄">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目錄
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      命令系统架构
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      快速开始
    </span>
  </a>
  
    <nav class="md-nav" aria-label="快速开始">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      创建自定义命令
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      异步命令示例
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      内置命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="内置命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      项目管理命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="项目管理命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#startproject-" class="md-nav__link">
    <span class="md-ellipsis">
      startproject - 创建新项目
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#startapp-" class="md-nav__link">
    <span class="md-ellipsis">
      startapp - 创建新应用
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      开发工具命令
    </span>
  </a>
  
    <nav class="md-nav" aria-label="开发工具命令">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shell-shell" class="md-nav__link">
    <span class="md-ellipsis">
      shell - 交互式 Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-openapi-openapi" class="md-nav__link">
    <span class="md-ellipsis">
      export-openapi - 导出 OpenAPI 文档
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aerich" class="md-nav__link">
    <span class="md-ellipsis">
      数据库迁移命令（Aerich）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="数据库迁移命令（Aerich）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#init-db-" class="md-nav__link">
    <span class="md-ellipsis">
      init-db - 初始化数据库
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrate-" class="md-nav__link">
    <span class="md-ellipsis">
      migrate - 生成迁移文件
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgrade-" class="md-nav__link">
    <span class="md-ellipsis">
      upgrade - 执行迁移
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#downgrade-" class="md-nav__link">
    <span class="md-ellipsis">
      downgrade - 回滚迁移
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#history-" class="md-nav__link">
    <span class="md-ellipsis">
      history - 查看迁移历史
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#heads-" class="md-nav__link">
    <span class="md-ellipsis">
      heads - 查看迁移头
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#inspectdb-" class="md-nav__link">
    <span class="md-ellipsis">
      inspectdb - 检查数据库
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      启动开发服务器
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      命令扩展
    </span>
  </a>
  
    <nav class="md-nav" aria-label="命令扩展">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unfazed_1" class="md-nav__link">
    <span class="md-ellipsis">
      访问 Unfazed 应用实例
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      错误处理
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      高级用法
    </span>
  </a>
  
    <nav class="md-nav" aria-label="高级用法">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      命令参数类型
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="unfazed">Unfazed 命令系统</h1>
<p>Unfazed 提供强大的命令行工具系统，类似 Django 的 management commands，支持同步和异步命令执行。</p>
<h2 id="_1">命令系统架构</h2>
<p>Unfazed 的命令系统基于 Click 框架构建，提供以下核心组件：</p>
<ul>
<li><strong>BaseCommand</strong>: 所有命令的基类，支持同步和异步执行</li>
<li><strong>CommandCenter</strong>: 命令管理中心，负责加载和管理命令</li>
<li><strong>CliCommandCenter</strong>: CLI 专用命令中心，用于处理项目级别的命令</li>
</ul>
<h2 id="_2">快速开始</h2>
<h3 id="_3">创建自定义命令</h3>
<p>在 app 下创建一个命令：</p>
<p>1、在 app 文件夹下创建 <code>commands</code> 文件夹</p>
<pre><code class="language-shell">mkdir app/commands
</code></pre>
<p>2、在 <code>commands</code> 文件夹下创建一个命令文件</p>
<pre><code class="language-shell">touch app/commands/hello.py
</code></pre>
<p>3、在 <code>hello.py</code> 文件中编写命令</p>
<pre><code class="language-python"># app/commands/hello.py
from unfazed.command import BaseCommand
from click import Option
import typing as t


class Command(BaseCommand):
    help_text = &quot;打招呼命令 - 向指定的人问好&quot;

    def add_arguments(self) -&gt; t.List[Option]:
        return [
            Option(
                [&quot;--name&quot;, &quot;-n&quot;], 
                help=&quot;你的名字&quot;, 
                required=True,
                type=str
            ),
            Option(
                [&quot;--greeting&quot;, &quot;-g&quot;], 
                help=&quot;问候语&quot;, 
                default=&quot;Hello&quot;,
                type=str
            )
        ]

    def handle(self, **options: t.Any) -&gt; None:
        name = options[&quot;name&quot;]
        greeting = options[&quot;greeting&quot;]
        print(f&quot;{greeting}, {name}!&quot;)
</code></pre>
<h3 id="_4">异步命令示例</h3>
<pre><code class="language-python"># app/commands/async_hello.py
from unfazed.command import BaseCommand
from click import Option
import typing as t
import asyncio


class Command(BaseCommand):
    help_text = &quot;异步问候命令&quot;

    def add_arguments(self) -&gt; t.List[Option]:
        return [
            Option([&quot;--name&quot;, &quot;-n&quot;], help=&quot;你的名字&quot;, required=True),
            Option([&quot;--delay&quot;, &quot;-d&quot;], help=&quot;延迟秒数&quot;, default=1, type=int)
        ]

    async def handle(self, **options: t.Any) -&gt; None:
        name = options[&quot;name&quot;]
        delay = options[&quot;delay&quot;]

        print(f&quot;正在准备问候 {name}...&quot;)
        await asyncio.sleep(delay)
        print(f&quot;Hello, {name}! (延迟了 {delay} 秒)&quot;)
</code></pre>
<p>4、运行命令</p>
<pre><code class="language-shell"># 运行同步命令
unfazed-cli hello --name unfazed --greeting &quot;你好&quot;
# 你好, unfazed!

# 运行异步命令
unfazed-cli async-hello --name unfazed --delay 2
# 正在准备问候 unfazed...
# Hello, unfazed! (延迟了 2 秒)
</code></pre>
<h2 id="_5">内置命令</h2>
<p>Unfazed 提供了丰富的内置命令，涵盖项目创建、应用管理、数据库迁移等功能。</p>
<h3 id="_6">项目管理命令</h3>
<h4 id="startproject-">startproject - 创建新项目</h4>
<p>创建一个新的 Unfazed 项目骨架。</p>
<pre><code class="language-shell"># 创建项目
unfazed-cli startproject -n myproject

# 指定创建位置
unfazed-cli startproject -n myproject -l /path/to/location
</code></pre>
<p><strong>参数说明：</strong>
- <code>--project_name, -n</code>: 项目名称（必需）
- <code>--location, -l</code>: 项目创建位置（默认为当前目录）</p>
<h4 id="startapp-">startapp - 创建新应用</h4>
<p>在现有项目中创建新的应用模块。</p>
<pre><code class="language-shell"># 创建标准应用（推荐）
unfazed-cli startapp -n myapp

# 创建简单应用
unfazed-cli startapp -n myapp -t simple

# 指定创建位置
unfazed-cli startapp -n myapp -l /path/to/apps
</code></pre>
<p><strong>参数说明：</strong>
- <code>--app_name, -n</code>: 应用名称（必需）
- <code>--location, -l</code>: 应用创建位置（默认为当前目录）
- <code>--template, -t</code>: 模板类型（<code>simple</code> 或 <code>standard</code>，默认为 <code>standard</code>）</p>
<p><strong>模板类型：</strong>
- <strong>simple</strong>: 基础模板，包含最少的文件
- <strong>standard</strong>: 标准模板，包含完整的应用结构</p>
<h3 id="_7">开发工具命令</h3>
<h4 id="shell-shell">shell - 交互式 Shell</h4>
<p>启动带有 Unfazed 应用上下文的交互式 Python Shell。</p>
<pre><code class="language-shell">unfazed-cli shell
</code></pre>
<p><strong>功能特性：</strong>
- 自动导入 Unfazed 应用实例
- 支持 IPython（如果已安装）
- 内置 asyncio 支持，可直接使用 <code>await</code>
- 预设变量：<code>unfazed</code> - 当前应用实例</p>
<h4 id="export-openapi-openapi">export-openapi - 导出 OpenAPI 文档</h4>
<p>将应用的 OpenAPI 规范导出为 YAML 文件。</p>
<pre><code class="language-shell"># 导出到当前目录
unfazed-cli export-openapi

# 指定导出位置
unfazed-cli export-openapi -l /path/to/export
</code></pre>
<p><strong>参数说明：</strong>
- <code>--location, -l</code>: 导出文件位置（默认为当前目录）</p>
<p><strong>注意：</strong> 需要安装 <code>pyyaml</code> 依赖。</p>
<h3 id="aerich">数据库迁移命令（Aerich）</h3>
<p>Unfazed 集成了 Aerich 作为 Tortoise ORM 的数据库迁移工具，提供完整的数据库版本管理功能。</p>
<h4 id="init-db-">init-db - 初始化数据库</h4>
<p>初始化迁移环境并创建初始迁移配置。</p>
<pre><code class="language-shell"># 初始化数据库迁移
unfazed-cli init-db

# 指定迁移文件位置
unfazed-cli init-db -l ./custom_migrations
</code></pre>
<p><strong>参数说明：</strong>
- <code>--location, -l</code>: 迁移文件存储位置（默认为 <code>./migrations</code>）
- <code>--safe, -s</code>: 安全模式（默认为 <code>True</code>）</p>
<h4 id="migrate-">migrate - 生成迁移文件</h4>
<p>检测模型变化并生成迁移文件。</p>
<pre><code class="language-shell"># 生成迁移文件
unfazed-cli migrate

# 指定迁移名称
unfazed-cli migrate -n &quot;add_user_model&quot;

# 指定迁移文件位置
unfazed-cli migrate -l ./custom_migrations
</code></pre>
<p><strong>参数说明：</strong>
- <code>--location, -l</code>: 迁移文件存储位置（默认为 <code>./migrations</code>）
- <code>--name, -n</code>: 迁移文件名称（默认为 <code>update</code>）</p>
<h4 id="upgrade-">upgrade - 执行迁移</h4>
<p>应用挂起的迁移到数据库。</p>
<pre><code class="language-shell"># 执行所有挂起的迁移
unfazed-cli upgrade

# 指定迁移文件位置
unfazed-cli upgrade -l ./custom_migrations

# 禁用事务模式
unfazed-cli upgrade -t False
</code></pre>
<p><strong>参数说明：</strong>
- <code>--location, -l</code>: 迁移文件存储位置（默认为 <code>./migrations</code>）
- <code>--transaction, -t</code>: 是否在事务中运行（默认为 <code>True</code>）</p>
<h4 id="downgrade-">downgrade - 回滚迁移</h4>
<p>回滚数据库到指定版本。</p>
<pre><code class="language-shell"># 回滚到上一个版本
unfazed-cli downgrade

# 回滚到指定版本
unfazed-cli downgrade -v 20231201_01

# 回滚时删除迁移文件
unfazed-cli downgrade -d True
</code></pre>
<p><strong>参数说明：</strong>
- <code>--location, -l</code>: 迁移文件存储位置（默认为 <code>./migrations</code>）
- <code>--version, -v</code>: 要回滚到的版本（默认为 <code>-1</code>，即上一版本）
- <code>--delete, -d</code>: 是否删除迁移文件（默认为 <code>True</code>）</p>
<h4 id="history-">history - 查看迁移历史</h4>
<p>显示所有迁移历史记录。</p>
<pre><code class="language-shell"># 查看迁移历史
unfazed-cli history

# 指定迁移文件位置
unfazed-cli history -l ./custom_migrations
</code></pre>
<h4 id="heads-">heads - 查看迁移头</h4>
<p>显示当前可用的迁移头信息。</p>
<pre><code class="language-shell"># 查看迁移头
unfazed-cli heads

# 指定迁移文件位置
unfazed-cli heads -l ./custom_migrations
</code></pre>
<h4 id="inspectdb-">inspectdb - 检查数据库</h4>
<p>从现有数据库生成模型代码。</p>
<pre><code class="language-shell"># 检查所有表
unfazed-cli inspectdb

# 检查指定表
unfazed-cli inspectdb -t users -t orders

# 指定迁移文件位置
unfazed-cli inspectdb -l ./custom_migrations
</code></pre>
<p><strong>参数说明：</strong>
- <code>--location, -l</code>: 迁移文件存储位置（默认为 <code>./migrations</code>）
- <code>--tables, -t</code>: 要检查的表名（可多次指定）</p>
<h3 id="_8">启动开发服务器</h3>
<p>Unfazed 推荐使用 Uvicorn 作为 ASGI 服务器来运行应用：</p>
<pre><code class="language-shell"># 启动开发服务器
uvicorn asgi:application --host 0.0.0.0 --port 9527

# 启用热重载
uvicorn asgi:application --host 0.0.0.0 --port 9527 --reload

# 或者使用 Makefile（如果项目包含）
make run
</code></pre>
<h2 id="_9">命令扩展</h2>
<h3 id="unfazed_1">访问 Unfazed 应用实例</h3>
<p>在自定义命令中，可以通过 <code>self.unfazed</code> 访问应用实例：</p>
<pre><code class="language-python">class Command(BaseCommand):
    help_text = &quot;展示应用信息&quot;

    async def handle(self, **options: t.Any) -&gt; None:
        # 访问应用配置
        print(f&quot;应用名称: {self.unfazed.settings.APP_NAME}&quot;)

        # 访问数据库
        if self.unfazed.settings.DATABASE:
            print(f&quot;数据库配置: {self.unfazed.settings.DATABASE}&quot;)

        # 访问应用注册中心
        print(f&quot;已注册应用数量: {len(list(self.unfazed.app_center))}&quot;)
</code></pre>
<h3 id="_10">错误处理</h3>
<p>命令系统会自动处理异常，建议在命令中使用适当的错误处理：</p>
<pre><code class="language-python">class Command(BaseCommand):
    help_text = &quot;带错误处理的命令&quot;

    async def handle(self, **options: t.Any) -&gt; None:
        try:
            # 命令逻辑
            await some_async_operation()
        except ValueError as e:
            print(f&quot;参数错误: {e}&quot;)
            raise  # 重新抛出异常以正确退出
        except Exception as e:
            print(f&quot;执行失败: {e}&quot;)
            raise
</code></pre>
<h2 id="_11">高级用法</h2>
<h3 id="_12">命令参数类型</h3>
<p>Click 支持多种参数类型，以下是常用的参数配置：</p>
<pre><code class="language-python">from click import Option, Choice, Path as ClickPath, IntRange
import typing as t

class Command(BaseCommand):
    help_text = &quot;高级参数示例&quot;

    def add_arguments(self) -&gt; t.List[Option]:
        return [
            # 字符串选择
            Option(
                [&quot;--mode&quot;, &quot;-m&quot;],
                type=Choice([&quot;dev&quot;, &quot;prod&quot;, &quot;test&quot;]),
                default=&quot;dev&quot;,
                help=&quot;运行模式&quot;
            ),
            # 文件路径
            Option(
                [&quot;--config&quot;, &quot;-c&quot;],
                type=ClickPath(exists=True, file_okay=True, dir_okay=False),
                help=&quot;配置文件路径&quot;
            ),
            # 数字范围
            Option(
                [&quot;--workers&quot;, &quot;-w&quot;],
                type=IntRange(1, 20),
                default=4,
                help=&quot;工作进程数量 (1-20)&quot;
            ),
            # 多值选项
            Option(
                [&quot;--apps&quot;, &quot;-a&quot;],
                multiple=True,
                help=&quot;要处理的应用列表&quot;
            ),
            # 布尔标志
            Option(
                [&quot;--verbose&quot;, &quot;-v&quot;],
                is_flag=True,
                help=&quot;详细输出&quot;
            )
        ]
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u62f7\u8c9d", "clipboard.copy": "\u62f7\u8c9d", "search.result.more.one": "\u6b64\u9801\u5c1a\u6709 1 \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.more.other": "\u6b64\u9801\u5c1a\u6709 # \u500b\u7b26\u5408\u7684\u9805\u76ee", "search.result.none": "\u6c92\u6709\u627e\u5230\u7b26\u5408\u689d\u4ef6\u7684\u7d50\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u689d\u4ef6\u7684\u7d50\u679c", "search.result.other": "\u627e\u5230 # \u500b\u7b26\u5408\u689d\u4ef6\u7684\u7d50\u679c", "search.result.placeholder": "\u9375\u5165\u4ee5\u958b\u59cb\u6aa2\u7d22", "search.result.term.missing": "\u7f3a\u5931", "select.version": "\u9078\u64c7\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>